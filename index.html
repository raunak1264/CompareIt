<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simple Code Comparison Tool</title>
    <style>
        /* Basic Reset */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            padding: 20px;
            max-width: 1200px;
            margin: 0 auto;
        }

        h1 {
            text-align: center;
            margin-bottom: 20px;
            color: #2c3e50;
        }

        .controls {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
            justify-content: center;
        }

        button {
            padding: 8px 12px;
            background-color: #3498db;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
        }

        button:hover {
            background-color: #2980b9;
        }

        .secondary {
            background-color: #95a5a6;
        }

        .secondary:hover {
            background-color: #7f8c8d;
        }

        .editor-container {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
        }

        @media (max-width: 768px) {
            .editor-container {
                flex-direction: column;
            }
        }

        .editor-panel {
            flex: 1;
            border: 1px solid #ddd;
            border-radius: 5px;
            overflow: hidden;
        }

        .panel-header {
            padding: 10px;
            background-color: #f5f5f5;
            border-bottom: 1px solid #ddd;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .panel-title {
            font-weight: bold;
        }

        textarea {
            width: 100%;
            height: 400px;
            padding: 10px;
            border: none;
            resize: none;
            font-family: monospace;
            font-size: 14px;
        }

        textarea:focus {
            outline: none;
        }

        .diff-view {
            display: none;
            width: 100%;
            height: 400px;
            padding: 10px;
            overflow: auto;
            font-family: monospace;
            font-size: 14px;
            white-space: pre-wrap;
        }

        .diff-added {
            background-color: #e6ffed;
            color: #22863a;
        }

        .diff-removed {
            background-color: #ffeef0;
            color: #cb2431;
            text-decoration: line-through;
        }

        .status {
            text-align: center;
            font-size: 14px;
            color: #666;
            margin-top: 10px;
        }

        .examples-container {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
            justify-content: center;
        }

        .example-btn {
            padding: 5px 10px;
            background-color: #f5f5f5;
            border: 1px solid #ddd;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
        }

        .example-btn:hover {
            background-color: #eee;
        }
    </style>
</head>
<body>
    <h1>Simple Code Comparison Tool</h1>

    <div class="examples-container">
        <span>Examples:</span>
        <button class="example-btn" data-example="javascript">JavaScript</button>
        <button class="example-btn" data-example="python">Python</button>
        <button class="example-btn" data-example="html">HTML</button>
        <button class="example-btn" data-example="json">JSON</button>
    </div>

    <div class="controls">
        <button id="compare-btn">Compare Differences</button>
        <button id="reset-btn" class="secondary">Reset</button>
        <button id="download-btn">Download Comparison</button>
    </div>

    <div class="editor-container">
        <div class="editor-panel">
            <div class="panel-header">
                <div class="panel-title">Original Code</div>
                <button id="clear-left" class="secondary">Clear</button>
            </div>
            <textarea id="left-editor" placeholder="Paste or type your original code here..."></textarea>
            <div id="left-diff" class="diff-view"></div>
        </div>

        <div class="editor-panel">
            <div class="panel-header">
                <div class="panel-title">Modified Code</div>
                <button id="clear-right" class="secondary">Clear</button>
            </div>
            <textarea id="right-editor" placeholder="Paste or type your modified code here..."></textarea>
            <div id="right-diff" class="diff-view"></div>
        </div>
    </div>

    <div class="status" id="status">Characters: 0 / 0 | Lines: 0 / 0 | Differences: 0</div>

    <script>
        // Example data
        const examples = {
            javascript: {
                left: `function calculateTotal(items) {\n  let total = 0;\n  \n  for (let i = 0; i < items.length; i++) {\n    total += items[i].price;\n  }\n  \n  return total;\n}`,
                right: `function calculateTotal(items) {\n  return items.reduce((total, item) => {\n    return total + item.price;\n  }, 0);\n}`
            },
            python: {
                left: `class User:\n    def __init__(self, name, email):\n        self.name = name\n        self.email = email\n        \n    def get_info(self):\n        return f"{self.name} ({self.email})"`,
                right: `class User:\n    def __init__(self, name, email, role="user"):\n        self.name = name\n        self.email = email\n        self.role = role\n        \n    def get_info(self):\n        return f"{self.name} ({self.email}) - {self.role}"\n        \n    def is_admin(self):\n        return self.role == "admin"`
            },
            html: {
                left: `<!DOCTYPE html>\n<html>\n<head>\n    <title>My Website</title>\n</head>\n<body>\n    <h1>Welcome</h1>\n    <p>This is my website.</p>\n</body>\n</html>`,
                right: `<!DOCTYPE html>\n<html>\n<head>\n    <title>My Website</title>\n    <link rel="stylesheet" href="styles.css">\n</head>\n<body>\n    <header>\n        <h1>Welcome to My Website</h1>\n    </header>\n    <main>\n        <p>This is my website.</p>\n    </main>\n    <footer>&copy; 2025</footer>\n</body>\n</html>`
            },
            json: {
                left: `{\n  "name": "My App",\n  "version": "1.0.0",\n  "description": "A sample application",\n  "main": "index.js",\n  "scripts": {\n    "start": "node index.js",\n    "test": "jest"\n  }\n}`,
                right: `{\n  "name": "My App",\n  "version": "1.1.0",\n  "description": "A sample application with new features",\n  "main": "index.js",\n  "scripts": {\n    "start": "node index.js",\n    "dev": "nodemon index.js",\n    "test": "jest",\n    "build": "webpack"\n  },\n  "dependencies": {\n    "express": "^4.17.1"\n  }\n}`
            }
        };

        // DOM elements
        const leftEditor = document.getElementById('left-editor');
        const rightEditor = document.getElementById('right-editor');
        const leftDiff = document.getElementById('left-diff');
        const rightDiff = document.getElementById('right-diff');
        const compareBtn = document.getElementById('compare-btn');
        const resetBtn = document.getElementById('reset-btn');
        const downloadBtn = document.getElementById('download-btn');
        const clearLeftBtn = document.getElementById('clear-left');
        const clearRightBtn = document.getElementById('clear-right');
        const statusDisplay = document.getElementById('status');
        const exampleBtns = document.querySelectorAll('.example-btn');

        // Helper function to escape HTML
        function escapeHtml(unsafe) {
            return unsafe
                .replace(/&/g, "&amp;")
                .replace(/</g, "&lt;")
                .replace(/>/g, "&gt;")
                .replace(/"/g, "&quot;")
                .replace(/'/g, "&#039;");
        }

        // Update statistics display
        function updateStats() {
            const leftText = leftEditor.value;
            const rightText = rightEditor.value;
            
            const leftCharCount = leftText.length;
            const rightCharCount = rightText.length;
            const leftLineCount = leftText ? leftText.split('\n').length : 0;
            const rightLineCount = rightText ? rightText.split('\n').length : 0;
            
            statusDisplay.textContent = `Characters: ${leftCharCount} / ${rightCharCount} | Lines: ${leftLineCount} / ${rightLineCount} | Differences: 0`;
        }

        // Simple line-by-line diff implementation
        function simpleDiff(oldText, newText) {
            const oldLines = oldText.split('\n');
            const newLines = newText.split('\n');
            
            const leftResult = [];
            const rightResult = [];
            let diffCount = 0;
            
            // Find common prefix length
            let commonPrefix = 0;
            const minLength = Math.min(oldLines.length, newLines.length);
            
            while (commonPrefix < minLength && oldLines[commonPrefix] === newLines[commonPrefix]) {
                commonPrefix++;
            }
            
            // Find common suffix length
            let commonSuffix = 0;
            while (
                commonSuffix < minLength - commonPrefix &&
                oldLines[oldLines.length - 1 - commonSuffix] === newLines[newLines.length - 1 - commonSuffix]
            ) {
                commonSuffix++;
            }
            
            // Add common prefix lines
            for (let i = 0; i < commonPrefix; i++) {
                leftResult.push({ text: oldLines[i], type: 'common' });
                rightResult.push({ text: newLines[i], type: 'common' });
            }
            
            // Add different parts
            for (let i = commonPrefix; i < oldLines.length - commonSuffix; i++) {
                leftResult.push({ text: oldLines[i], type: 'removed' });
                diffCount++;
            }
            
            for (let i = commonPrefix; i < newLines.length - commonSuffix; i++) {
                rightResult.push({ text: newLines[i], type: 'added' });
                diffCount++;
            }
            
            // Add common suffix lines
            for (let i = 0; i < commonSuffix; i++) {
                const oldIndex = oldLines.length - commonSuffix + i;
                const newIndex = newLines.length - commonSuffix + i;
                
                leftResult.push({ text: oldLines[oldIndex], type: 'common' });
                rightResult.push({ text: newLines[newIndex], type: 'common' });
            }
            
            return { left: leftResult, right: rightResult, diffCount };
        }

        // Compare the code and display differences
        function compareCode() {
            const leftText = leftEditor.value;
            const rightText = rightEditor.value;
            
            // Perform diff
            const diff = simpleDiff(leftText, rightText);
            
            // Update status with diff count
            statusDisplay.textContent = statusDisplay.textContent.replace(
                /Differences: \d+/, 
                `Differences: ${diff.diffCount}`
            );
            
            // Generate HTML
            let leftHtml = '';
            let rightHtml = '';
            
            diff.left.forEach(line => {
                if (line.type === 'common') {
                    leftHtml += `<div>${escapeHtml(line.text)}</div>`;
                } else if (line.type === 'removed') {
                    leftHtml += `<div class="diff-removed">${escapeHtml(line.text)}</div>`;
                }
            });
            
            diff.right.forEach(line => {
                if (line.type === 'common') {
                    rightHtml += `<div>${escapeHtml(line.text)}</div>`;
                } else if (line.type === 'added') {
                    rightHtml += `<div class="diff-added">${escapeHtml(line.text)}</div>`;
                }
            });
            
            // Show diff views, hide editors
            leftEditor.style.display = 'none';
            rightEditor.style.display = 'none';
            leftDiff.style.display = 'block';
            rightDiff.style.display = 'block';
            
            // Set HTML content
            leftDiff.innerHTML = leftHtml;
            rightDiff.innerHTML = rightHtml;
        }

        // Reset editors and views
        function resetEditors() {
            leftEditor.value = '';
            rightEditor.value = '';
            resetViews();
            updateStats();
        }

        // Reset views
        function resetViews() {
            leftDiff.innerHTML = '';
            rightDiff.innerHTML = '';
            leftEditor.style.display = 'block';
            rightEditor.style.display = 'block';
            leftDiff.style.display = 'none';
            rightDiff.style.display = 'none';
        }

        // Load an example
        function loadExample(type) {
            if (examples[type]) {
                resetViews();
                leftEditor.value = examples[type].left;
                rightEditor.value = examples[type].right;
                updateStats();
            }
        }

        // Download comparison as HTML
        function downloadComparison() {
            const leftText = leftEditor.value;
            const rightText = rightEditor.value;
            
            const html = `
<!DOCTYPE html>
<html>
<head>
    <title>Code Comparison</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        h1 { margin-bottom: 20px; }
        .comparison-container { display: flex; gap: 20px; }
        .panel { flex: 1; border: 1px solid #ddd; border-radius: 5px; overflow: hidden; }
        .panel-header { background-color: #f5f5f5; padding: 10px; border-bottom: 1px solid #ddd; }
        pre { margin: 0; padding: 10px; white-space: pre-wrap; overflow: auto; max-height: 600px; }
    </style>
</head>
<body>
    <h1>Code Comparison</h1>
    <div class="comparison-container">
        <div class="panel">
            <div class="panel-header">Original</div>
            <pre>${escapeHtml(leftText)}</pre>
        </div>
        <div class="panel">
            <div class="panel-header">Modified</div>
            <pre>${escapeHtml(rightText)}</pre>
        </div>
    </div>
    <div style="margin-top: 20px; color: #666;">
        Generated on ${new Date().toLocaleString()}
    </div>
</body>
</html>`;
            
            // Create blob and download
            const blob = new Blob([html], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'code-comparison.html';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        // Event listeners
        compareBtn.addEventListener('click', compareCode);
        resetBtn.addEventListener('click', resetEditors);
        downloadBtn.addEventListener('click', downloadComparison);
        
        clearLeftBtn.addEventListener('click', function() {
            leftEditor.value = '';
            resetViews();
            updateStats();
        });
        
        clearRightBtn.addEventListener('click', function() {
            rightEditor.value = '';
            resetViews();
            updateStats();
        });
        
        leftEditor.addEventListener('input', function() {
            resetViews();
            updateStats();
        });
        
        rightEditor.addEventListener('input', function() {
            resetViews();
            updateStats();
        });
        
        // Example buttons
        exampleBtns.forEach(btn => {
            btn.addEventListener('click', function() {
                const exampleType = this.getAttribute('data-example');
                loadExample(exampleType);
            });
        });

        // Initialize
        updateStats();
    </script>
</body>
</html>
